var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Unit=function(){function Unit(name,race){this.name=name;this.race=race}return Unit}();var Recipe=function(_super){__extends(Recipe,_super);function Recipe(name,race,ingredients,tier){var _this=_super.call(this,name,race)||this;_this.ingredients=ingredients;_this.tier=tier;return _this}Recipe.prototype.getRecipeUnits=function(unitType,unitArray){if(unitType=="immediate"){return this.ingredients}else if(unitType=="basic"){var unitNode=new NodeItem(this,1);var nodeList=unitNode.getDescendents(unitArray);return combineObjs(nodeList)}else if(unitType=="magic"){var unitNode=new NodeItem(this,1);var nodeList=unitNode.getDescendents(unitArray,true);return combineObjs(nodeList)}};return Recipe}(Unit);var NodeItem=function(){function NodeItem(unit,modifier){this.unit=unit;this.modifier=modifier}NodeItem.prototype.getChildNodes=function(unitArray){var ingredients=this.unit.ingredients;if(!ingredients){return false}var childNodes=[];var unitNames=unitArray.map(function(x){return x.name});for(var ingredient in ingredients){var index=unitNames.indexOf(ingredient);childNodes.push(new NodeItem(unitArray[index],ingredients[ingredient]*this.modifier))}return childNodes};NodeItem.prototype.getDescendents=function(unitArray,magic){var children=this.getChildNodes(unitArray);var newChildren=[];if(magic&&!(this.getChildNodes(unitArray)[0].unit instanceof Recipe)){return[this]}if(children){for(var i=0;i<children.length;i++){var grandchildren=children[i].getDescendents(unitArray,magic);if(grandchildren.length){newChildren=newChildren.concat(grandchildren)}}return newChildren}else{return[this]}};return NodeItem}();var createElement=function(elem,innerText,toAppend,cssClass,id){var newElem=document.createElement(elem);if(cssClass){newElem.className=cssClass}if(id){newElem.id=id}var newText=document.createTextNode(innerText);newElem.appendChild(newText);toAppend.appendChild(newElem);return newElem};var getPrettyStr=function(prop){return prop.replace(/_/g," ")};var combineObjs=function(objArr){var newObj={};for(var i=0;i<objArr.length;i++){var name_1=objArr[i].unit.name;if(newObj[name_1]){newObj[name_1]+=objArr[i].modifier}else{newObj[name_1]=objArr[i].modifier}}return newObj};var readData=function(unitData){var units;units=[];for(var i=0;i<unitData.length;i++){var current=unitData[i];if(!current.type){current.type="basic"}if(current.ingredients){units.push(new Recipe(current.name,current.race,current.ingredients,current.tier))}else{units.push(new Unit(current.name,current.race))}}return units};var printObjToTable=function(obj,toAppend){var table=createElement("table","",toAppend);for(var prop in obj){var row=createElement("tr","",table);var col2=createElement("td",""+Math.round(obj[prop]*100)/100,row);var col1=createElement("td",getPrettyStr(prop),row)}};var clickCallback=function(){var recipeType=document.getElementById("recipeType").value;var children=this.nextSibling.children;var targetElem=children[0];if(recipeType==="Immediate"){targetElem=targetElem.nextSibling}else if(recipeType==="Magic"){targetElem=targetElem.nextSibling.nextSibling}if(targetElem.style.display==="block"){targetElem.style.display=""}else{for(var i=0;i<children.length;i++){children[i].style.display=""}targetElem.style.display="block"}};var sortData=function(oldArr){var newArr=[];for(var i=0;i<oldArr.length;i++){if(oldArr[i]instanceof Recipe){newArr.push(oldArr[i])}else{newArr.unshift(oldArr[i])}}return newArr};var filterResults=function(elem){document.getElementById("hiddenCheck").checked=true;document.getElementById("basicCheck").checked=true;var searchTerm=elem.value;if(!searchTerm){searchTerm=""}searchTerm=searchTerm.replace(/ /g,"_");var recipes=document.getElementsByClassName("recipe");for(var i=0;i<recipes.length;i++){if(recipes[i].id.indexOf(searchTerm)===-1){recipes[i].style.display="none"}else{recipes[i].style.display="block"}}};var toggleUnits=function(elem,unitType){var unitsToToggle=document.getElementsByClassName(unitType);var display;if(elem.checked){display=""}else{display="none"}for(var i=0;i<unitsToToggle.length;i++){unitsToToggle[i].style.display=display}};var f_main=function(unitData){var units=readData(unitData);units=sortData(units);var main=document.getElementById("main");for(var i=0;i<units.length;i++){var name_2=getPrettyStr(units[i].name);var unitElem=createElement("div","",main,"unit",units[i].name);createElement("h4",name_2,unitElem,"unit-title");if(units[i]instanceof Recipe){unitElem.className="recipe "+units[i].tier;if(units[i].tier!=="hidden"){unitElem.className=unitElem.className+" basic"}var showButton=createElement("button","Recipe",unitElem);showButton.addEventListener("click",clickCallback);var recipesContainer=createElement("div","",unitElem,"recipes-container");var basicContainer=createElement("div","",recipesContainer,"basic-units");var immediateContainer=createElement("div","",recipesContainer,"immediate-units");var magicContainer=createElement("div","",recipesContainer,"magic-units");var immediateRecipe=units[i].getRecipeUnits("immediate",units);var basicRecipe=units[i].getRecipeUnits("basic",units);var magicRecipe=units[i].getRecipeUnits("magic",units);printObjToTable(immediateRecipe,immediateContainer);printObjToTable(basicRecipe,basicContainer);printObjToTable(magicRecipe,magicContainer)}}};window.onload=function(){f_main(unitData)};